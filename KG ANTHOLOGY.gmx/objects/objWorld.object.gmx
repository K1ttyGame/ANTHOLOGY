<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-1000000</depth>
  <persistent>-1</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//make sure we never have more than one world object

if (instance_number(object_index) &gt; 1)
{
    instance_destroy();
}
else
{
    //initialize everything
    
    //initialize all variables
    scrInitializeGlobals();
    
    //load the current config file, sets default config if it doesn't exist
    scrLoadConfig();
    
    //configure sounds
    scrBalanceSound();
    
    room_goto_next();
}

drawStatY = -128
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///pause current music when it's done fading out

audio_pause_sound(global.currentMusic);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///function keys

if (keyboard_check_pressed(vk_escape))
{
    game_end();
}

if (keyboard_check_pressed(vk_f2))
{
    scrRestartGame();
    exit;
}

if (keyboard_check_pressed(vk_f4) &amp;&amp; !global.gamePaused)    //toggle fullscreen mode
{
    global.fullscreenMode = !global.fullscreenMode;
    
    window_set_fullscreen(global.fullscreenMode);
    
    scrSaveConfig();    //save fullscreen setting
}

if (keyboard_check(vk_control) &amp;&amp; keyboard_check_pressed(ord("M")) &amp;&amp; !global.gamePaused)
{
    //toggle mute music setting
    scrToggleMusic();
    
    scrSaveConfig();    //save mute setting
}

//show level info
if (keyboard_check(ord('1')))
    drawStatY = lerp(drawStatY, 0, .1)
else
    drawStatY = lerp(drawStatY, -128, .1)
    

//debug keys: REMOVE UPON RELEASE



if (keyboard_check_pressed(vk_pageup) &amp;&amp; !global.gamePaused &amp;&amp; room_next(room) != -1){ 
    room_goto_next()
    if (instance_exists(objPlayer)) {
        with objPlayer instance_destroy()
    }
}

if (keyboard_check_pressed(vk_pagedown) &amp;&amp; !global.gamePaused &amp;&amp; room_previous(room) != -1){ 
    room_goto_previous()
    if (instance_exists(objPlayer)) {
        with objPlayer instance_destroy()
    }
}

if (keyboard_check_pressed(vk_home) &amp;&amp; !global.gamePaused){ 
    if (global.noDeath == true)
        global.noDeath = false
    else
        global.noDeath = true
}

if (keyboard_check_pressed(vk_end) &amp;&amp; !global.gamePaused){ 
    if (global.infJump == true)
        global.infJump = false
    else
        global.infJump = true
}

if (keyboard_check_pressed(vk_insert) &amp;&amp; !global.gamePaused){ 
    if (instance_exists(objPlayer))
        scrSaveGame(true)
    audio_play_sound(sndNumberBeep, 10, false)
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>objWorld</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///game checks

if (global.gameStarted)
{
    //handle pausing
    if (global.pauseDelay &lt;= 0) //check if pause delay is active
    {
        if (keyboard_check_pressed(global.pauseButton) &amp;&amp; !instance_exists(objRestartBlocker))
        //if (0) //disables pausing
        {
            if (!global.gamePaused)  //game currently not paused, pause the game
            {
                if (!global.noPause)
                {
                    global.gamePaused = true;  //set the game to paused
                    global.pauseDelay = global.pauseDelayLength; //set pause delay
                    
                    instance_deactivate_all(true);  //deactivate everything
                    
                    global.pauseSurf = surface_create(surface_get_width(application_surface),surface_get_height(application_surface));    //create new surface
                    surface_copy(global.pauseSurf,0,0,application_surface);             //copy current screen to it
                }
            }
            else    //game currently paused, unpause the game
            {
                global.gamePaused = false;  //set the game to unpaused
                global.pauseDelay = global.pauseDelayLength;     //set pause delay
                
                instance_activate_all();    //reactivate objects
                
                if (surface_exists(global.pauseSurf))
                    surface_free(global.pauseSurf);         //free the surface
                
                scrSaveConfig();    //save config in case volume levels were changed
                
                io_clear(); //clear input states to prevent possible pause strats/exploits
            }
        }
    }
    else
    {
        global.pauseDelay -= 1;
    }
    
    //if (!global.gamePaused) and ((instance_exists(objPlayer) &amp;&amp; objPlayer.frozen == false)) //check if the game is currently paused
    if (!global.gamePaused) //new line, delete if broken
    {
        if (keyboard_check_pressed(global.restartButton) &amp;&amp; !instance_exists(objRestartBlocker))
        {
            //stop death sound/music
            audio_stop_sound(global.deathSound);
            audio_stop_sound(global.gameOverMusic);
            
            //resume room music
            audio_resume_sound(global.currentMusic);
            
            ///return to old gain if music is being faded out
            if (global.musicFading)
            {
                global.musicFading = false;
                audio_sound_gain(global.currentMusic,global.currentGain,0);
                alarm[0] = -1;   //reset alarm that pauses music
            }
            
            scrSaveGame(false); //save death/time
            scrLoadGame(false); //load the game
        }
        
        global.timeMicro += delta_time;
        global.time += global.timeMicro div 1000000;
        global.timeMicro = global.timeMicro mod 1000000;
    }
    else    //game is paused, check for volume controls
    {
        if (keyboard_check(global.upButton))
        {
            if (global.volumeLevel &lt; 100)
                global.volumeLevel += 1;
        }
        else if (keyboard_check(global.downButton))
        {
            if (global.volumeLevel &gt; 0)
                global.volumeLevel -= 1;
        }
        
        audio_master_gain(global.volumeLevel/100);  //set master gain
    }
    
    scrSetRoomCaption();    //keep caption updated
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="10">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///fade current music out
global.musicFading = true;
global.currentGain = audio_sound_get_gain(global.currentMusic);     //get current gain
audio_sound_gain(global.currentMusic,0,1000);                       //fade out music over 1 second

alarm[0] = 50;  //pause music when it's done fading
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="4">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///room checks

scrGetMusic();  //find and play the proper music for the current room

room_speed = 50;    //make sure game is running at the correct frame rate
scrSetRoomCaption();    //make sure window caption stays updated

if !instance_exists(objRedBorderDrawer)
    instance_create(0, 0, objRedBorderDrawer)

    
//ambient check
switch (room) {
    case rSnow0:
    case rSnowTransition:
    case rSnow1:
    case rSnow2:
    case rSnow3:
    case rSnow4:
    case rSnow5:
    case rSnow6:
    case rSnow7:
    case rSnow8:
    case rSnowTransition2:
    case r7:
    case r8:
    case r9:
    case r10:
    case rFieldTransition:
        if !audio_is_playing(musWindAmbient1) audio_play_sound(musWindAmbient1, 10, true)
        audio_stop_sound(musBeachAmbient)
        audio_stop_sound(musStormAmbient)
        break;
    case rBeachCard:
    case rBeachIntro:
    case rBeachHotel:
    case rBeachHammock:
    case rBeachHammock2:
    case rBeachBasketball:
    case rBeachDrink1:
    case rBeachDrink2:
    case rBeachCombo:
    case rBeachCutscene:
    case rBeachNight1:
    case rBeachNight2:
    case rBeachNight3:
        if !audio_is_playing(musBeachAmbient) audio_play_sound(musBeachAmbient, 10, true)
        audio_stop_sound(musWindAmbient1)
        audio_stop_sound(musStormAmbient)
        break;
    case rStorm1:
    case rStorm2:
    case rStorm3:
    case rStorm4:
    case rStorm5:
    case rStorm6:
    case rStormCutscene:
        if !audio_is_playing(musStormAmbient) audio_play_sound(musStormAmbient, 10, true)
        audio_stop_sound(musWindAmbient1)
        audio_stop_sound(musBeachAmbient)
        break;
    default: //have it stop all ambient sounds here
        audio_stop_sound(musWindAmbient1)
        audio_stop_sound(musBeachAmbient)
        audio_stop_sound(musStormAmbient)
        break;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///initialize everything

//initialize all variables
scrInitializeGlobals();

//load the current config file, sets default config if it doesn't exist
scrLoadConfig();

room_goto_next();
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="64">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///draw pause screen

if (global.gamePaused)  //check if game is paused to draw the pause screen
{
    draw_clear(c_black);
    
    if (surface_exists(global.pauseSurf))       //check if surface exists before drawing it
        draw_surface(global.pauseSurf,0,0);
    
    draw_set_color(c_black);
    draw_set_alpha(0.4);
    
    draw_rectangle(-1,-1,display_get_gui_width(),display_get_gui_height(),0);    //darken the paused screen
    
    draw_set_alpha(1);
    
    draw_set_color(c_white);
    
    draw_set_halign(fa_center);
    draw_set_font(fDefault30);
    
    draw_text(display_get_gui_width()/2,display_get_gui_height()/2 - 24,"PAUSE");
    
    draw_set_halign(fa_left);
    draw_set_font(fDefault18);
    
    var t = global.time;
    var timeText = string(t div 3600) + ":";
    t = t mod 3600;
    timeText += string(t div 600);
    t = t mod 600;
    timeText += string(t div 60) + ":";
    t = t mod 60;
    timeText += string(t div 10);
    t = t mod 10;
    timeText += string(floor(t));
    
    draw_text(20,516,"Volume: " + string(global.volumeLevel) + "%");
    draw_text(20,541,"Deaths: " + string(global.death));
    draw_text(20,566,"Time: " + timeText);
}

//debug code
draw_set_halign(fa_right)
draw_set_valign(fa_top)
draw_set_font(fFrozenTitle)

scrDrawTextOutline(792, 0+drawStatY, "IL Time: " + string(global.time-global.startTime), c_black, c_white)
scrDrawTextOutline(792, 32+drawStatY, "IL Deaths: " + string(global.death-global.startDeath), c_black, c_white)

//draw_text(64, 16, "Run Time:" + string(global.time-global.startTime))
//draw_text(64, 48, "Run Deaths:" + string(global.death-global.startDeath))
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
